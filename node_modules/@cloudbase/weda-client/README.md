## 使用说明

请查看[文档](./docs/%E5%A4%96%E9%83%A8%E6%96%87%E6%A1%A3.md)

## demo 使用说明

为了成功访问企业工作台，避免跨域问题，端口必须是 8080。
如遇到跨域问题，有如下原因：

1. 端口不是 8080
2. 环境不存在

启动命令：

```
# 安装依赖
npm i
npm run demo
```

## 如何发布

注意点：

- 一定要重新安装，确保安装正确的依赖版本。特别是`@cloudbase/weda-cloud-sdk`
- prepulish 已经有`npm i && npm run build`，因为这是 yarn 项目，可能会失败，如失败需要再次执行`npm i`、`npm run build`(由于有问题，暂时去掉了 prepublish)

<font size=5>严格按照以下顺序执行发布！！！</font>
1、删除 node_modules、lock 文件
rm -rf node_modules yarn.lock package-lock.json

2、安装依赖

```
npm i
```

3、执行构建

```
npm run build
```

4、修改 package.json 版本号，记得提交到 git 上；执行发布

```
npm publish
```

## dev 如何预览修改

### web

weda-client 会被 weda-render 引用，构建 weda-render 的时候会被直接打包到产物中。

1. 在本项目中执行 `yarn develop:esm`
2. 参考 [weda-render 文档](../weda-render/CONTRIBUTING.md) 跑 dev。weda-client 更新时，webpack 可能监听不到，此时重启weda-render 的 webpack 即可。

tip: 如果代理没有生效，可以尝试开启 Chrome Network 选项卡下的 disable cache 功能

### 小程序

1. 构建 weda-client: `yarn build`
2. 删除小程序中的 weda-client: `rm -fr path-to-your-mp-project/miniprogram_npm/@cloudbase/weda-client`
3. 构建软链: `ln -s path-to-weda-alternative/packages/weda-client/miniprogram path-to-your-mp-project/miniprogram_npm/@cloudbase/weda-client`
4. 清除缓存、重新编译，查看修改后代码效果
