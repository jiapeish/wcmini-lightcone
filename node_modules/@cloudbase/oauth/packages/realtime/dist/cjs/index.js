"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.registerRealtime = void 0;
var websocket_client_1 = require("./websocket-client");
var common_1 = require("./common");
var hook = {
    target: 'database',
    entity: function () {
        var _a = this.platform, adapter = _a.adapter, runtime = _a.runtime;
        (0, common_1.setWsClass)(adapter.wsClass);
        (0, common_1.setRuntime)(runtime);
    },
};
var component = {
    name: 'realtime',
    IIFE: true,
    entity: function () {
        this.prototype.wsClientClass = websocket_client_1.RealtimeWebSocketClient;
    },
};
try {
    cloudbase.registerComponent(component);
    cloudbase.registerHook(hook);
}
catch (e) { }
function registerRealtime(app) {
    try {
        app.registerComponent(component);
        app.registerHook(hook);
    }
    catch (e) {
        console.warn(e);
    }
}
exports.registerRealtime = registerRealtime;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQ0EsdURBQTREO0FBQzVELG1DQUFpRDtBQUtqRCxJQUFNLElBQUksR0FBbUI7SUFDM0IsTUFBTSxFQUFFLFVBQVU7SUFDbEIsTUFBTTtRQUNFLElBQUEsS0FBdUIsSUFBSSxDQUFDLFFBQVEsRUFBbEMsT0FBTyxhQUFBLEVBQUUsT0FBTyxhQUFrQixDQUFBO1FBQzFDLElBQUEsbUJBQVUsRUFBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUE7UUFDM0IsSUFBQSxtQkFBVSxFQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQ3JCLENBQUM7Q0FDRixDQUFBO0FBRUQsSUFBTSxTQUFTLEdBQXdCO0lBQ3JDLElBQUksRUFBRSxVQUFVO0lBQ2hCLElBQUksRUFBRSxJQUFJO0lBQ1YsTUFBTTtRQUNKLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxHQUFHLDBDQUF1QixDQUFBO0lBQ3hELENBQUM7Q0FDRixDQUFBO0FBRUQsSUFBSTtJQUNGLFNBQVMsQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsQ0FBQTtJQUN0QyxTQUFTLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFBO0NBQzdCO0FBQUMsT0FBTyxDQUFDLEVBQUUsR0FBRTtBQUVkLFNBQWdCLGdCQUFnQixDQUFDLEdBQXlEO0lBQ3hGLElBQUk7UUFDRixHQUFHLENBQUMsaUJBQWlCLENBQUMsU0FBUyxDQUFDLENBQUE7UUFDaEMsR0FBRyxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQTtLQUN2QjtJQUFDLE9BQU8sQ0FBQyxFQUFFO1FBQ1YsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQTtLQUNoQjtBQUNILENBQUM7QUFQRCw0Q0FPQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElDbG91ZGJhc2UgfSBmcm9tICdAY2xvdWRiYXNlL3R5cGVzJ1xuaW1wb3J0IHsgUmVhbHRpbWVXZWJTb2NrZXRDbGllbnQgfSBmcm9tICcuL3dlYnNvY2tldC1jbGllbnQnXG5pbXBvcnQgeyBzZXRXc0NsYXNzLCBzZXRSdW50aW1lIH0gZnJvbSAnLi9jb21tb24nXG5pbXBvcnQgeyBJQ2xvdWRiYXNlQ29tcG9uZW50LCBJQ2xvdWRiYXNlSG9vayB9IGZyb20gJ0BjbG91ZGJhc2UvdHlwZXMvY29tcG9uZW50J1xuXG5kZWNsYXJlIGNvbnN0IGNsb3VkYmFzZTogSUNsb3VkYmFzZVxuXG5jb25zdCBob29rOiBJQ2xvdWRiYXNlSG9vayA9IHtcbiAgdGFyZ2V0OiAnZGF0YWJhc2UnLFxuICBlbnRpdHkoKSB7XG4gICAgY29uc3QgeyBhZGFwdGVyLCBydW50aW1lIH0gPSB0aGlzLnBsYXRmb3JtXG4gICAgc2V0V3NDbGFzcyhhZGFwdGVyLndzQ2xhc3MpXG4gICAgc2V0UnVudGltZShydW50aW1lKVxuICB9LFxufVxuXG5jb25zdCBjb21wb25lbnQ6IElDbG91ZGJhc2VDb21wb25lbnQgPSB7XG4gIG5hbWU6ICdyZWFsdGltZScsXG4gIElJRkU6IHRydWUsXG4gIGVudGl0eSgpIHtcbiAgICB0aGlzLnByb3RvdHlwZS53c0NsaWVudENsYXNzID0gUmVhbHRpbWVXZWJTb2NrZXRDbGllbnRcbiAgfSxcbn1cblxudHJ5IHtcbiAgY2xvdWRiYXNlLnJlZ2lzdGVyQ29tcG9uZW50KGNvbXBvbmVudClcbiAgY2xvdWRiYXNlLnJlZ2lzdGVySG9vayhob29rKVxufSBjYXRjaCAoZSkge31cblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyUmVhbHRpbWUoYXBwOiBQaWNrPElDbG91ZGJhc2UsICdyZWdpc3RlckNvbXBvbmVudCd8J3JlZ2lzdGVySG9vayc+KSB7XG4gIHRyeSB7XG4gICAgYXBwLnJlZ2lzdGVyQ29tcG9uZW50KGNvbXBvbmVudClcbiAgICBhcHAucmVnaXN0ZXJIb29rKGhvb2spXG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLndhcm4oZSlcbiAgfVxufVxuIl19